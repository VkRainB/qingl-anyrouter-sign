# 🚀 AnyRouter 青龙面板适配版本

## 📝 PR 概述

本PR为 AnyRouter 自动签到脚本提供了完整的青龙面板适配版本，让用户可以在青龙面板中稳定运行自动签到任务。

## ✨ 主要改进

### 🎯 核心功能保持
- ✅ **多账号签到**: 完整保留原有的多账号批量签到功能  
- ✅ **WAF绕过**: 使用Playwright自动绕过网站防护
- ✅ **容错处理**: 支持部分账号失败，不影响其他账号

### 🔧 青龙环境优化
- ✅ **去除依赖**: 移除了 `python-dotenv` 依赖，直接读取系统环境变量
- ✅ **无头模式**: Playwright改为headless模式，适合服务器环境  
- ✅ **标准日志**: 采用青龙标准的日志格式 `[时间] [级别] 信息`
- ✅ **异常处理**: 增强了青龙环境下的错误处理机制

### 📢 通知系统升级
- ✅ **多平台支持**: 企业微信、钉钉、飞书、PushPlus、Server酱、Telegram
- ✅ **智能降级**: 未配置通知时自动降级为控制台输出
- ✅ **批量推送**: 支持同时向多个平台发送通知

## 📁 新增文件

| 文件名 | 说明 |
|--------|------|
| `qinglong/anyrouter_checkin.py` | 主签到脚本（青龙优化版） |
| `qinglong/ql_notify.py` | 青龙通知系统 |
| `qinglong/requirements.txt` | 依赖文件 |
| `qinglong/README.md` | 详细使用说明 |
| `qinglong/install.sh` | 一键安装脚本 |
| `qinglong/环境变量配置示例.txt` | 配置参考文档 |

## 🧪 测试文件

| 文件名 | 说明 |
|--------|------|
| `qinglong/qinglong_test.py` | 完整环境测试脚本 |
| `qinglong/syntax_check.py` | 语法和逻辑检查工具 |
| `qinglong/test_mock.py` | 核心功能模拟测试 |

## 🔍 质量保证

### ✅ 测试覆盖
- **语法检查**: 所有Python文件语法正确 ✅
- **逻辑测试**: 核心功能逻辑验证通过 ✅  
- **环境兼容**: 青龙环境适配验证 ✅
- **配置验证**: JSON格式和结构验证 ✅
- **异步测试**: 异步函数结构测试通过 ✅

### 🛠️ 修复的问题
- **函数命名冲突**: 修正了通知函数的命名问题
- **Playwright配置**: 优化了青龙环境下的浏览器启动参数
- **超时设置**: 调整了网络请求超时时间
- **错误处理**: 增强了异常捕获和处理逻辑

## 🚀 部署方式

### 快速部署
```bash
# 上传所有文件到青龙面板脚本目录后
bash install.sh
```

### 手动部署
1. 上传脚本文件到 `/ql/scripts/`
2. 安装依赖: `pip3 install -r requirements.txt`
3. 安装浏览器: `playwright install chromium`  
4. 配置环境变量: `ANYROUTER_ACCOUNTS`
5. 创建定时任务

## 📊 环境要求

- **Python**: 3.8+
- **平台**: Linux (青龙面板)
- **依赖**: httpx[http2], playwright
- **内存**: 建议512MB+ (运行浏览器)

## 🎯 使用场景

### 个人用户
- 多账号自动签到
- 定时任务管理
- 签到结果通知

### 高级用户  
- 批量账号管理
- 多种通知方式
- 自定义配置

## 📋 配置示例

```json
// ANYROUTER_ACCOUNTS 环境变量
[
  {
    "cookies": {"session": "your_session_value"},
    "api_user": "your_api_user_id"
  }
]
```

## 🔧 兼容性说明

- **向后兼容**: 保持与原版功能完全一致
- **配置兼容**: 支持原版的账号配置格式  
- **通知兼容**: 支持原版通知方式并扩展新方式

## 🌟 特色亮点

1. **一键部署**: `install.sh` 脚本自动化配置所有环境
2. **智能检测**: 自动检测青龙环境和依赖状态
3. **详细文档**: 完整的部署和使用说明
4. **测试完备**: 多层次测试确保代码质量
5. **用户友好**: 清晰的日志输出和错误提示

## 🤝 测试建议

建议在合并前进行以下测试：
1. 在真实青龙环境中部署测试
2. 验证多账号签到功能
3. 测试各种通知方式
4. 检查异常处理机制
5. 验证定时任务执行

## 📞 技术支持

如有问题，请参考：
- `qinglong/README.md` - 详细使用说明
- `qinglong/qinglong_test.py` - 环境诊断工具
- Issues 反馈具体问题

---

这个青龙适配版本让 AnyRouter 签到脚本能够完美融入青龙面板生态，为用户提供更稳定、更便捷的自动签到体验！ 🎉